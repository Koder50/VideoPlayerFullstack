"use strict";(self.webpackChunksuperheroes=self.webpackChunksuperheroes||[]).push([[34],{9034:(P,L,m)=>{m.r(L),m.d(L,{AuthModule:()=>de,localStorageSyncReducer:()=>H});var M=m(9808),A=m(3007),y=m(5620),h=(()=>{return(e=h||(h={})).LOGIN="[AUTH] Login",e.SET_TOKEN="[AUTH] Set Token",e.CREATE_USER="[AUTH] Create User",e.LOGIN_ERROR="[AUTH] LOGIN_ERROR",h;var e})();const x=(0,y.PH)(h.SET_TOKEN,(0,y.Ky)()),R=(0,y.PH)(h.LOGIN_ERROR,(0,y.Ky)()),N=(0,y.ZF)("authState");var t=m(5e3),j=m(8682),w=m(1271),O=m(3075),I=m(9224),S=m(4106),F=m(7531),i=m(7423);function a(e,o){if(1&e&&(t.TgZ(0,"p",7),t._uU(1),t.qZA()),2&e){const r=t.oxw();t.xp6(1),t.hij(" ",r.error," ")}}const l=function(){return["register"]};function v(e,o){1&e&&(t.TgZ(0,"p",8),t._uU(1,"Create account"),t.qZA()),2&e&&t.Q6J("routerLink",t.DdM(1,l))}const d=function(){return[""]};function Z(e,o){1&e&&(t.TgZ(0,"p",8),t._uU(1,"Sign In"),t.qZA()),2&e&&t.Q6J("routerLink",t.DdM(1,d))}let G=(()=>{class e{constructor(r){this.fb=r,this.error="",this.title="Login",this.submitEmitter=new t.vpe,this.form=this.fb.group({email:[""],password:[""]})}ngOnInit(){}submit(){this.submitEmitter.emit(this.form.value)}}return e.\u0275fac=function(r){return new(r||e)(t.Y36(O.qu))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-auth-form"]],inputs:{error:"error",title:"title"},outputs:{submitEmitter:"submitEmitter"},decls:17,vars:6,consts:[[3,"formGroup","ngSubmit"],["class","error",4,"ngIf"],["type","text","matInput","","placeholder","Username","formControlName","email"],["type","password","matInput","","placeholder","Password","formControlName","password"],[1,"button"],["type","submit","mat-button",""],["class","link","routerLinkActive","router-link-active",3,"routerLink",4,"ngIf"],[1,"error"],["routerLinkActive","router-link-active",1,"link",3,"routerLink"]],template:function(r,u){1&r&&(t.TgZ(0,"mat-card")(1,"mat-card-title"),t._uU(2),t.qZA(),t.TgZ(3,"mat-card-content")(4,"form",0),t.NdJ("ngSubmit",function(){return u.submit()}),t.YNc(5,a,2,1,"p",1),t.TgZ(6,"p")(7,"mat-form-field"),t._UZ(8,"input",2),t.qZA()(),t.TgZ(9,"p")(10,"mat-form-field"),t._UZ(11,"input",3),t.qZA()(),t.TgZ(12,"div",4)(13,"button",5),t._uU(14),t.qZA()(),t.YNc(15,v,2,2,"p",6),t.YNc(16,Z,2,2,"p",6),t.qZA()()()),2&r&&(t.xp6(2),t.Oqu(u.title),t.xp6(2),t.Q6J("formGroup",u.form),t.xp6(1),t.Q6J("ngIf",u.error),t.xp6(9),t.Oqu(u.title),t.xp6(1),t.Q6J("ngIf","Login"==u.title),t.xp6(1),t.Q6J("ngIf","Register"==u.title))},directives:[I.a8,I.n5,I.dn,O._Y,O.JL,O.sg,M.O5,S.KE,F.Nt,O.Fj,O.JJ,O.u,i.lW,A.Od,A.rH],styles:["[_nghost-%COMP%]{display:flex;justify-content:center;margin:100px 0}.mat-form-field[_ngcontent-%COMP%]{width:100%;min-width:300px}mat-card-title[_ngcontent-%COMP%], mat-card-content[_ngcontent-%COMP%]{display:flex;justify-content:center}.error[_ngcontent-%COMP%]{padding:16px;width:300px;color:#fff;background-color:red}.button[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}.link[_ngcontent-%COMP%]{cursor:pointer;text-decoration:underline}"]}),e})();const Q=[{path:"",component:(()=>{class e{constructor(r,u,f,s){this.store=r,this.authService=u,this.router=f,this._snackBar=s,this.error$=this.store.select((0,y.P1)(N,e=>e.error)),this.checkJWT(),this.getError()}submit(r){this.store.dispatch({type:h.LOGIN,payload:r}),localStorage.setItem("userEmail",r.email)}getError(){this.error$.subscribe(r=>{r&&this._snackBar.open(r.message,"Error")})}checkJWT(){this.authService.isAuthenticated()&&this.router.navigate(["/video-players"])}}return e.\u0275fac=function(r){return new(r||e)(t.Y36(y.yh),t.Y36(j.i),t.Y36(A.F0),t.Y36(w.ux))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-login"]],decls:1,vars:0,consts:[[3,"submitEmitter"]],template:function(r,u){1&r&&(t.TgZ(0,"app-auth-form",0),t.NdJ("submitEmitter",function(s){return u.submit(s)}),t.qZA())},directives:[G],styles:[""]}),e})()},{path:"register",component:(()=>{class e{constructor(r){this.store=r,this.error=""}ngOnInit(){}submit(r){this.store.dispatch({type:h.CREATE_USER,payload:r})}}return e.\u0275fac=function(r){return new(r||e)(t.Y36(y.yh))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-register"]],decls:1,vars:0,consts:[["title","Register",3,"submitEmitter"]],template:function(r,u){1&r&&(t.TgZ(0,"app-auth-form",0),t.NdJ("submitEmitter",function(s){return u.submit(s)}),t.qZA())},directives:[G],styles:[""]}),e})()}];let W=(()=>{class e{}return e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[A.Bz.forChild(Q)],A.Bz]}),e})();var X=m(521),V=m(520);let q=(()=>{class e{constructor(r){if(r)throw new Error("Core module should only be imported to the Root Module")}}return e.\u0275fac=function(r){return new(r||e)(t.LFG(e,12))},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({providers:[j.i],imports:[[M.ez,V.JF]]}),e})();var C=m(4394);function z(e,o,r,u,f,s,n){try{var c=e[s](n),g=c.value}catch(E){return void r(E)}c.done?o(g):Promise.resolve(g).then(u,f)}function K(e){return function(){var o=this,r=arguments;return new Promise(function(u,f){var s=e.apply(o,r);function n(g){z(s,u,f,n,c,"next",g)}function c(g){z(s,u,f,n,c,"throw",g)}n(void 0)})}}var $=m(5577),_=m(4004),Y=m(8505),D=m(262);let k=(()=>{class e{constructor(r,u,f){this.actions$=r,this.authService=u,this.router=f,this.loginUser$=(0,C.GW)(()=>this.actions$.pipe((0,C.l4)(h.LOGIN),(0,$.z)(s=>this.authService.login(s.payload).pipe((0,_.U)(n=>({type:h.SET_TOKEN,token:n.token})),(0,Y.b)(()=>this.router.navigate(["video-players"])),(0,D.K)(function(){var n=K(function*(c){return{type:h.LOGIN_ERROR,error:c.error}});return function(c){return n.apply(this,arguments)}}())))),{dispatch:!0}),this.createUser$=(0,C.GW)(()=>this.actions$.pipe((0,C.l4)(h.CREATE_USER),(0,$.z)(s=>this.authService.register(s.payload).pipe((0,Y.b)(()=>this.router.navigate(["login"])),(0,D.K)(function(){var n=K(function*(c){return{type:h.LOGIN_ERROR,error:c.error}});return function(c){return n.apply(this,arguments)}}())))),{dispatch:!0})}}return e.\u0275fac=function(r){return new(r||e)(t.LFG(C.eX),t.LFG(j.i),t.LFG(A.F0))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac}),e})();const te=(0,y.Lq)({userDetails:null,token:"",error:null},(0,y.on)(x,(e,{token:o})=>Object.assign(Object.assign({},e),{token:o})),(0,y.on)(R,(e,{error:o})=>Object.assign(Object.assign({},e),{error:o})));var re=m(4999);const J="@ngrx/store/init",oe=/(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})/,ie=(e,o)=>"string"==typeof o&&oe.test(o)?new Date(o):o,se=(e,o)=>o;function B(e,o){return o.reduce((r,u)=>{if("string"==typeof u||"number"==typeof u){const f=null==e?void 0:e[u];void 0!==f&&(r[u]=f)}else for(const f in u)Object.prototype.hasOwnProperty.call(u,f)&&(r[f]=B(e[f],u[f]));return r},{})}const le=(e,o,r,u,f,s)=>{if(s)try{if(!0!==s(e))return}catch(n){if(n instanceof TypeError)return;throw n}o.forEach(n=>{let g,E,b,c=e[n];if("object"==typeof n){let p=Object.keys(n)[0];if(c=e[p],void 0!==c&&n[p]){if(n[p].serialize)c=n[p].serialize(c);else{let T;n[p].reduce?T=n[p]:n[p].filter&&(T=n[p].filter),T&&(c=B(c,T)),n[p].encrypt&&n[p].decrypt?"function"==typeof n[p].encrypt&&(b=n[p].encrypt):(n[p].encrypt||n[p].decrypt)&&console.error(`Either encrypt or decrypt function is not present on '${n[p]}' key object.`)}g=n[p].replacer,E=n[p].space}n=p}if(void 0!==c&&void 0!==r)try{b&&(c=b("string"==typeof c?c:JSON.stringify(c,g,E))),r.setItem(u(n),"string"==typeof c?c:JSON.stringify(c,g,E))}catch(p){console.warn("Unable to save state to localStorage:",p)}else if(void 0===c&&f&&void 0!==r)try{r.removeItem(u(n))}catch(p){console.warn(`Exception on removing/cleaning undefined '${n}' state`,p)}})},fe=(e,o,r)=>((r.type===J||"@ngrx/store/update-reducers"===r.type)&&o&&(e=re(e,o,{arrayMerge:(s,n,c)=>n})),e);function H(e){return(e=>o=>{(void 0===e.storage&&!e.checkStorageAvailability||e.checkStorageAvailability&&"undefined"!=typeof window)&&(e.storage=localStorage||window.localStorage),void 0===e.storageKeySerializer&&(e.storageKeySerializer=s=>s),void 0===e.restoreDates&&(e.restoreDates=!0);let r=e.mergeReducer;(void 0===r||"function"!=typeof r)&&(r=fe);const u=(e=>e.map(o=>{let r=o;if("object"==typeof o&&(r=Object.keys(o)[0]),"string"!=typeof r)throw new TypeError("localStorageSync Unknown Parameter Type: Expected type of string, got "+typeof r);return o}))(e.keys),f=e.rehydrate?((e,o,r,u)=>e.reduce((f,s)=>{let g,E,n=s,c=u?ie:se;if("object"==typeof n&&(n=Object.keys(n)[0],"function"==typeof s[n]?c=s[n]:(s[n].reviver&&(c=s[n].reviver),s[n].deserialize&&(g=s[n].deserialize)),s[n].encrypt&&s[n].decrypt?"function"==typeof s[n].encrypt&&"function"==typeof s[n].decrypt?E=s[n].decrypt:console.error(`Either encrypt or decrypt is not a function on '${s[n]}' key object.`):(s[n].encrypt||s[n].decrypt)&&console.error(`Either encrypt or decrypt function is not present on '${s[n]}' key object.`)),void 0!==o){let b=o.getItem(r(n));if(b){E&&(b=E(b));const p=new RegExp("{|\\[");let T=b;return("null"===b||"true"===b||"false"===b||p.test(b.charAt(0)))&&(T=JSON.parse(b,c)),Object.assign({},f,{[n]:g?g(T):T})}}return f},{}))(u,e.storage,e.storageKeySerializer,e.restoreDates):void 0;return function(s,n){let c;return c=n.type!==J||s?Object.assign({},s):o(s,n),c=r(c,f,n),c=o(c,n),n.type!==J&&le(c,u,e.storage,e.storageKeySerializer,e.removeOnUndefined,e.syncCondition),c}})({keys:["token"]})(e)}const me=[H];let de=(()=>{class e{}return e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[M.ez,W,X.q,O.u5,O.UX,q,y.Aw.forFeature("authState",te,{metaReducers:me}),C.sQ.forFeature([k])]]}),e})()},4999:P=>{var L=function(a){return function m(i){return!!i&&"object"==typeof i}(a)&&!function M(i){var a=Object.prototype.toString.call(i);return"[object RegExp]"===a||"[object Date]"===a||function h(i){return i.$$typeof===y}(i)}(a)},y="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function R(i,a){return!1!==a.clone&&a.isMergeableObject(i)?S(function x(i){return Array.isArray(i)?[]:{}}(i),i,a):i}function N(i,a,l){return i.concat(a).map(function(v){return R(v,l)})}function j(i){return Object.keys(i).concat(function t(i){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(i).filter(function(a){return i.propertyIsEnumerable(a)}):[]}(i))}function w(i,a){try{return a in i}catch(l){return!1}}function S(i,a,l){(l=l||{}).arrayMerge=l.arrayMerge||N,l.isMergeableObject=l.isMergeableObject||L,l.cloneUnlessOtherwiseSpecified=R;var v=Array.isArray(a);return v===Array.isArray(i)?v?l.arrayMerge(i,a,l):function I(i,a,l){var v={};return l.isMergeableObject(i)&&j(i).forEach(function(d){v[d]=R(i[d],l)}),j(a).forEach(function(d){(function O(i,a){return w(i,a)&&!(Object.hasOwnProperty.call(i,a)&&Object.propertyIsEnumerable.call(i,a))})(i,d)||(v[d]=w(i,d)&&l.isMergeableObject(a[d])?function U(i,a){if(!a.customMerge)return S;var l=a.customMerge(i);return"function"==typeof l?l:S}(d,l)(i[d],a[d],l):R(a[d],l))}),v}(i,a,l):R(a,l)}S.all=function(a,l){if(!Array.isArray(a))throw new Error("first argument should be an array");return a.reduce(function(v,d){return S(v,d,l)},{})},P.exports=S}}]);